<!DOCTYPE html>
<html class="no-js css-menubar" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta name="description" content="bootstrap admin template">
  <meta name="author" content="">

  <title>Visits</title>

  <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png">
  <link rel="shortcut icon" href="../assets/images/fav.ico">

  <!-- Stylesheets -->
   <link rel="manifest" href="../manifest.json">
  <link rel="stylesheet" href="../global/css/bootstrap.min.css">
  <link rel="stylesheet" href="../global/css/bootstrap-extend.min.css">
  <link rel="stylesheet" href="../assets/css/site.min.css">
  <link rel="stylesheet" href="../global/vendor/slidepanel/slidePanel.css">
  <!-- Plugins -->
  <link rel="stylesheet" href="../global/vendor/animsition/animsition.css">
  <link rel="stylesheet" href="../global/vendor/asscrollable/asScrollable.css">
  <link rel="stylesheet" href="../global/vendor/switchery/switchery.css">
  <link rel="stylesheet" href="../global/vendor/intro-js/introjs.css">
  <link rel="stylesheet" href="../global/vendor/flag-icon-css/flag-icon.css">

  <!-- Fonts -->
  <link rel="stylesheet" href="../global/fonts/web-icons/web-icons.min.css">
  <link rel="stylesheet" href="../global/fonts/brand-icons/brand-icons.min.css">
  <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>
  <link rel="stylesheet" href="../global/fontawesome/css/all.min.css" />
  <!--[if lt IE 9]>
    <script src="../global/vendor/html5shiv/html5shiv.min.js"></script>
    <![endif]-->

  <!--[if lt IE 10]>
    <script src="../global/vendor/media-match/media.match.min.js"></script>
    <script src="../global/vendor/respond/respond.min.js"></script>
    <![endif]-->

  <!-- Scripts -->
  <script src="../global/vendor/breakpoints/breakpoints.js"></script>
  <script>
    Breakpoints();
  </script>

</head>

<body class="animsition">
  <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

  <nav class="site-navbar navbar navbar-default navbar-fixed-top navbar-mega" role="navigation">

    <div class="navbar-header">
      <button type="button" class="navbar-toggler hamburger hamburger-close navbar-toggler-left hided"
        data-toggle="menubar">
        <span class="sr-only">Toggle navigation</span>
        <span class="hamburger-bar"></span>
      </button>
      <button type="button" class="navbar-toggler collapsed" data-target="#site-navbar-collapse" data-toggle="collapse">
        <i class="icon wb-more-horizontal" aria-hidden="true"></i>
      </button>
      <div class="navbar-brand navbar-brand-center site-gridmenu-toggle" data-toggle="gridmenu">
        <img class="navbar-brand-logo" src="../assets/images/amelogo.png" title="AME">
        
      </div>

    </div>

    <div class="navbar-container container-fluid">
      <!-- Navbar Collapse -->
      <div class="collapse navbar-collapse navbar-collapse-toolbar" id="site-navbar-collapse">
        <!-- Navbar Toolbar -->
        <ul class="nav navbar-toolbar">
          <li class="nav-item hidden-float" id="toggleMenubar">
            <a class="nav-link" data-toggle="menubar" href="#" role="button">
              <i class="icon hamburger hamburger-arrow-left">
                <span class="sr-only">Toggle menubar</span>
                <span class="hamburger-bar"></span>
              </i>
            </a>
          </li>
          <li class="nav-item hidden-sm-down" id="toggleFullscreen">
            <a class="nav-link icon icon-fullscreen" data-toggle="fullscreen" href="#" role="button">
              <span class="sr-only">Toggle fullscreen</span>
            </a>
          </li>

        </ul>
        <!-- End Navbar Toolbar -->

        <!-- Navbar Toolbar Right -->
        <ul class="nav navbar-toolbar navbar-right navbar-toolbar-right" style="padding-right: 100px;">
          <li class="nav-item dropdown">
            <a class="nav-link navbar-avatar" data-toggle="dropdown" href="#" aria-expanded="false"
              data-animation="scale-up" role="button">
              <p id="FullName"></p>
            </a>
            <div class="dropdown-menu" role="menu">

              <a class="dropdown-item" id="sett" href="../TopManagers/Setting.html" role="menuitem"><i
                  class="icon wb-settings" aria-hidden="true"></i> Settings</a>
              <div class="dropdown-divider" role="presentation"></div>
              <a class="dropdown-item logout" href="" role="menuitem"><i class="icon wb-power" aria-hidden="true"></i>
                Logout</a>
            </div>
          </li>
        </ul>
        <!-- End Navbar Toolbar Right -->
      </div>
      <!-- End Navbar Collapse -->


    </div>
  </nav>

 
  <div class="site-menubar">
    <div class="site-menubar-body">
      <div>
        <div>
          <ul class="site-menu" data-plugin="menu">
            <li class="site-menu-category">Menu</li>
            <li class="site-menu-item">
              <a class="animsition-link" href="../TopManagers/Home.html">
                <i class="site-menu-icon wb-layout" aria-hidden="true"></i>
                <span class="site-menu-title">Home</span>
              </a>
            </li>
            <li class="dropdown site-menu-item has-sub active">
              <a data-toggle="dropdown" data-dropdown-toggle="false" href="javascript:void(0)">
                <i class="fas fa-file site-menu-icon" aria-hidden="true"></i>
                      <span class="site-menu-title">Reports</span>
                      <i class="icon wb-chevron-down-mini" aria-hidden="true"></i>
                  </a>
                  <div class="dropdown-menu">
                    <div class="site-menu-scroll-wrap is-list">
                      <div>
                        <div>
                          <ul class="site-menu-sub site-menu-normal-list">
                            <li class="site-menu-item">
                              <a class="animsition-link"  href="../TopManagers/Visits.html">
                                <span class="site-menu-title">Visits Reports</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/CoverageReport.html">                                    
                                <span class="site-menu-title">Coverage Reports</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/CollectionReport.html">
                                <span class="site-menu-title">Collection Reports</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/BalanceReport.html">
                                <span class="site-menu-title">Balance Reports</span>
                              </a>
                            </li>
                            <li class="site-menu-item active">
                              <a class="animsition-link" href="../TopManagers/Target.html">
                                <span class="site-menu-title">Target Reports</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/Kpis.html">
                                <span class="site-menu-title">KPIs Reports</span>
                              </a>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
            </li>
           

            <li class="dropdown site-menu-item has-sub">
              <a data-toggle="dropdown" data-dropdown-toggle="false" href="javascript:void(0)">
                <i class="fas fa-calendar-day site-menu-icon" aria-hidden="true"></i>
                      <span class="site-menu-title">Time Off Territory</span>
                      <i class="icon wb-chevron-down-mini" aria-hidden="true"></i>
                  </a>
                  <div class="dropdown-menu">
                    <div class="site-menu-scroll-wrap is-list">
                      <div>
                        <div>
                          <ul class="site-menu-sub site-menu-normal-list">
                            <li class="site-menu-item">
                              <a class="animsition-link"  href="../TopManagers/TimeOffTerritory.html">
                                <span class="site-menu-title">Time Off Territory</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/MakeTimeOffTerritory.html">                                    
                                <span class="site-menu-title">Create Time Off Territory</span>
                              </a>
                            </li>
                            <li class="site-menu-item">
                              <a class="animsition-link" href="../TopManagers/TimeOffRequests.html">
                                <span class="site-menu-title">Time Off Territory Requests</span>
                              </a>
                            </li>
                      
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
            </li>
            <li class="site-menu-item">
              <a class="animsition-link" href="../TopManagers/MonthlyPlan.html">
                <i class="fas fa-calendar-day site-menu-icon" aria-hidden="true"></i>
                <span class="site-menu-title">Monthly Plans</span>
              </a>
            </li>
            <li class="site-menu-item">
              <a class="animsition-link" href="../TopManagers/WorkingDays.html">
                <i class="fas fa-clipboard site-menu-icon" aria-hidden="true"></i>
                <span class="site-menu-title">Working Days</span>
              </a>
            </li>
            <li class="site-menu-item">
              <a class="animsition-link" href="../TopManagers/VisitsComments.html">
                <i class="fas fa-comments site-menu-icon" aria-hidden="true"></i>
                <span class="site-menu-title">Visits Comments</span>
              </a>
            </li>
          </ul>
            </li>
          </div>
        </div>
      </div>
    </div>





  <!-- Page -->
  <div class="page" id="page">
    <div class="page-content">


      <div id="searchpanel" class="panel">
        <div class="panel-heading">
          <h2 class="panel-title">Search</h2>
          <div class="panel-actions panel-actions-keep">
            <a class="panel-action icon wb-minus" data-toggle="panel-collapse" aria-hidden="true"></a>
          </div>
        </div>
        <div class="panel-body">
          <div class="table-responsive">
            <table class="table table-borderless text-center">
              <thead>
                <tr>
                  <th><label class="form-control-label">Team:</label><select class="form-control"
                      id="teamsearch">
                      <option value="0">-- Choose Team --</option>
                    </select></th>
              </tr>
              <tr>
                  <th><label class="form-control-label">Category:</label><select class="form-control"
                    id="categorysearch">
                    <option value="0">-- All Categories --</option>
                  </select></th>
              </tr>
              <tr>
                  <th>
                    <label class="form-control-label">Month:</label><input type="month" id="searchstartdate"
                      class="form-control">
                  </th>
                  </tr>
              <tr>
                  <th colspan="3" class="text-center"><input type="button" id="search" value="Search" class="btn btn-primary"></th>
                  
                </tr>
                <tr>
                  <th colspan="3" class="text-center"> <button type="button" id="excel" class="btn btn-animate btn-animate-side btn-success btn-outline"> <span><i class="icon fas fa-file-excel" aria-hidden="true"></i> Export To Excel</span> </button></th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>

      <div id="resultspanel" class="panel d-none">

        <div class="panel-body">

          <div id="loading" class="col-12 d-none">
            <div>
              <div class=" h-150 vertical-align text-center">
                <div class="loader vertical-align-middle loader-tadpole"></div>
              </div>
            </div>
          </div>






          <div class="table-responsive">
            <table class="table table-hover text-center d-none" id="results">
              <thead id="resultshead">

              </thead>
              <tbody id="resultsbody">

              </tbody>
         
            </table>
          </div>

        </div>
      </div>
    </div>
  </div>

  
  

  <!-- End Page -->


  <!-- Core  -->
  <script src="../global/vendor/babel-external-helpers/babel-external-helpers.js"></script>
  <script src="../global/vendor/jquery/jquery.js"></script>
  <script src="../global/vendor/popper-js/umd/popper.min.js"></script>
  <script src="../global/vendor/bootstrap/bootstrap.js"></script>
  <script src="../global/vendor/animsition/animsition.js"></script>
  <script src="../global/vendor/mousewheel/jquery.mousewheel.js"></script>
  <script src="../global/vendor/asscrollbar/jquery-asScrollbar.js"></script>
  <script src="../global/vendor/asscrollable/jquery-asScrollable.js"></script>
  <script src="../global/vendor/ashoverscroll/jquery-asHoverScroll.js"></script>

  <!-- Plugins -->
  <script src="../global/vendor/switchery/switchery.js"></script>
  <script src="../global/vendor/intro-js/intro.js"></script>
  <script src="../global/vendor/screenfull/screenfull.js"></script>
  <script src="../global/vendor/slidepanel/jquery-slidePanel.js"></script>
  <script src="../global/fontawesome/js/all.min.js"></script>


  <!-- Scripts -->
  <script src="../global/js/Component.js"></script>
  <script src="../global/js/Plugin.js"></script>
  <script src="../global/js/Base.js"></script>
  <script src="../global/js/Config.js"></script>

  <script src="../assets/js/Section/Menubar.js"></script>
  <script src="../assets/js/Section/GridMenu.js"></script>
  <script src="../assets/js/Section/Sidebar.js"></script>
  <script src="../assets/js/Section/PageAside.js"></script>
  <script src="../assets/js/Plugin/menu.js"></script>
  <script src="../global/js/Plugin/slidepanel.js"></script>
  <script src="../global/js/config/colors.js"></script>
  <script src="../assets/js/config/tour.js"></script>
  <script>Config.set('assets', '../assets');</script>
  <script src="../global/js/Plugin/panel.js"></script>
  <!-- Page -->
  <script src="../assets/js/Site.js"></script>
  <script src="../global/js/Plugin/asscrollable.js"></script>
  <script src="../global/js/Plugin/slidepanel.js"></script>
  <script src="../global/js/Plugin/switchery.js"></script>
  <script src="../global/vendor/sparkline/jquery.sparkline.min.js"></script>
  <script src="../global/vendor/chartist/chartist.min.js"></script>
  <script src="../global/vendor/matchheight/jquery.matchHeight-min.js"></script>
  <script>
    (function (document, window, $) {
      'use strict';

      var Site = window.Site;
      $(document).ready(function () {
        Site.run();

        //start layout            
        if (localStorage.getItem("userrole") !== "Top Line Manager") {
          window.open("../notauth.html", "_self")
        }

        $("#FullName").append(localStorage.getItem("userfullname") + ' <span><i class="icon wb-chevron-down-mini" aria-hidden="true"></i></span>');



        $(".logout").click(function (e) {
          e.preventDefault();
          $.ajax({
            url: "http://localhost:53586/users/LogOut",
            success: function (res) {
              if (res == true) {
                window.localStorage.removeItem("userfullname");
                window.localStorage.removeItem("useremail");
                window.localStorage.removeItem("userid");
                window.localStorage.removeItem("userrole");
                window.open("../index.html", "_self")
              }
              else {
                window.open("../error.html", "_self")
              }
            }
          })
        })
        //end layout







        //teamsearch
    
        $.ajax({
          url: "http://localhost:53586/TopManager/GetAllFirstManagers",
          success: function (res) {
            
            $.each(res, function () {
             ;
              $("#teamsearch").append('<option value="' + this.id + '">' + this.fullName + '</option>');
            })
          }
        });


        $.ajax({
          url: "http://localhost:53586/Category/GetAllCategories",
          success: function (res) {

            $.each(res, function () {
              ;
              $("#categorysearch").append('<option value="' + this.id + '">' + this.categoryName + '</option>');
            })
          }
        });

        function unique(array) {
          return $.grep(array, function (el, index) {
            return index == $.inArray(el, array);
          });
        }






    



        $("#excel").click(function(){
         
          $("#teamsearch").removeAttr('style');
          $("#searchstartdate").removeAttr('style');
      

          if ($("#teamsearch").children('option:selected').val() == 0 || $("#searchstartdate").val() == "" || $("#searchstartdate").val() == null) {
            if ($("#teamsearch").children('option:selected').val() == 0) {
              $("#teamsearch").css("border-color", "#dc3545");
            }
            if ($("#searchstartdate").val() == "" || $("#searchstartdate").val() == null) {
              $("#searchstartdate").css("border-color", "#dc3545");
            }
         
            return;
          }

          var managerid = $("#teamsearch").children('option:selected').val()
        
          var categoryid = $("#categorysearch").children('option:selected').val();
          var date = $("#searchstartdate").val();
          var year = date.substring(0,4);
          var month = date.substring(5)

          
          window.open('http://localhost:53586/TopManager/GetTargetExcel/'+managerid+"/"+categoryid+"/"+month+"/"+year)
          
          

        })

        $("#search").click(function () {
          $("#teamsearch").removeAttr('style');
          $("#categorysearch").removeAttr("style");
          $("#searchstartdate").removeAttr('style');
      

          if ($("#teamsearch").children('option:selected').val() == 0 || $("#searchstartdate").val() == "" || $("#searchstartdate").val() == null) {
            if ($("#teamsearch").children('option:selected').val() == 0) {
              $("#teamsearch").css("border-color", "#dc3545");
            }
            
            if ($("#searchstartdate").val() == "" || $("#searchstartdate").val() == null) {
              $("#searchstartdate").css("border-color", "#dc3545");
            }
         
            return;
          }

          $("#resultshead").children('tr').remove();
          $("#resultsbody").children('tr').remove();

          $("#resultspanel").removeClass('d-none');
          $("#loading").removeClass('d-none');
          $("#searchpanel").addClass('is-collapse');
          var managerid = $("#teamsearch").children('option:selected').val()
          var categoryid = $("#categorysearch").children('option:selected').val();
          var date = $("#searchstartdate").val();
          var year = date.substring(0,4);
        
          var month = date.substring(5)
       
          //#region start accountmedicalvisit
         
            $("#resultshead").append('<tr> <th>Representative Name</th> <th>Contact</th> <th>Category</th> <th>Current Visits</th> <th>Target</th> </tr>');

            var obj = {"ManagerId":managerid,"CategoryId":categoryid,"Month":month,"Year":year}

      
     

            $.ajax({
              type: "POST",
              contentType: "application/json",
              url: "http://localhost:53586/TopManager/GetTarget",
              data: JSON.stringify(obj),
              success: function (res) {
                $.each(res, function () {

     

                  if (this.monthlyTarget == null) {
                    this.monthlyTarget = 0;
                  }


                  if (this.currentVisits == 0 || this.currentVisits <  this.monthlyTarget) {
                    this.currentVisits = '<span style="color:#CB0000;">'+this.currentVisits+'</span>'
                  }
                  else{
                    if (this.currentVisits >= this.monthlyTarget) {
                      this.currentVisits = '<span style="color:#20B000;">'+this.currentVisits+'</span>'
                    }
                  }


                
              

                  $("#resultsbody").append('<tr><td>' + this.fullName + '</td><td>' + this.contactName + '</td><td>'+this.categoryName+'</td><td>' + this.currentVisits + '</td><td>' + this.monthlyTarget + '</td></tr>')
                })
              }
            }).then(function () {
              $("#loading").addClass('d-none');
              $("#results").removeClass('d-none');
            })
          //#endregion end account medical visit

      
         
        })









    



   




       


      })


    })(document, window, jQuery);
  </script>
</body>

</html>